e(batch_size=256, bert_model_path='/cache/data/BertModel/', epochs=3, is_training=True, learning_rate=5e-05, log_path='/cache/output/pointwise/logs/BertSessionSearch.aol.log', per_gpu_batch_size=64, per_gpu_test_batch_size=128, pretrain_model_path='/cache/output/pretraining/models/BertContrastive.aol.5.10.128.sent_deletion', save_path='/cache/output/pointwise/models/bert_sessionsearch.aol.5.10.128.sent_deletion', score_file_path='/cache/output/BertContrastive.aol.5.10.128.sent_deletion.score.txt', score_file_pre_path='score_file.preq.txt', task='aol', test_batch_size=512)

Epoch  1 / 3
Best Result: MAP: 0.5171 MRR: 0.5265 NDCG@1: 0.3677 NDCG@3: 0.5129 NDCG@5: 0.5490 NDCG@10: 0.5816
Best Result: MAP: 0.5188 MRR: 0.5282 NDCG@1: 0.3704 NDCG@3: 0.5153 NDCG@5: 0.5495 NDCG@10: 0.5837
Best Result: MAP: 0.5216 MRR: 0.5307 NDCG@1: 0.3710 NDCG@3: 0.5197 NDCG@5: 0.5541 NDCG@10: 0.5869
Best Result: MAP: 0.5292 MRR: 0.5389 NDCG@1: 0.3834 NDCG@3: 0.5235 NDCG@5: 0.5626 NDCG@10: 0.5946
Best Result: MAP: 0.5426 MRR: 0.5519 NDCG@1: 0.3978 NDCG@3: 0.5408 NDCG@5: 0.5765 NDCG@10: 0.6059
Average loss:0.296840 

Epoch  2 / 3
Average loss:0.238336 

Epoch  3 / 3
Average loss:0.199979 
start test...
Best Result: MAP: 0.5472 MRR: 0.5576 NDCG@1: 0.4009 NDCG@3: 0.5444 NDCG@5: 0.5804 NDCG@10: 0.6121
Namespace(aug_strategy='term_deletion', batch_size=512, bert_model_path='/cache/data/BertModel/', epochs=5, is_training=True, learning_rate=5e-05, log_path='/cache/output/pretraining/logs/BertContrastive.aol.log', loss_path='/cache/output/pretraining/logs/BertContrastive.aol.train_cl_loss.log', per_gpu_batch_size=128, per_gpu_test_batch_size=256, save_path='/cache/output/pretraining/models/BertContrastive.aol.5.10.128.term_deletion', score_file_path='./output/aol/BertContrastive.aol.score_file.txt', task='aol', temperature=0.1, test_batch_size=1024)
* number of parameters: 109484544
start fitting.........
init train_dataset ok
init train_dataloader ok
init optimizer, bce_loss... ok


                                
Namespace(batch_size=256, bert_model_path='/cache/data/BertModel/', epochs=3, is_training=True, learning_rate=5e-05, log_path='/cache/output/pointwise/logs/BertSessionSearch.aol.log', per_gpu_batch_size=64, per_gpu_test_batch_size=128, pretrain_model_path='/cache/output/pretraining/models/BertContrastive.aol.5.10.128.term_deletion', save_path='/cache/output/pointwise/models/bert_sessionsearch.aol.5.10.128.term_deletion', score_file_path='/cache/output/BertContrastive.aol.5.10.128.term_deletion.score.txt', score_file_pre_path='score_file.preq.txt', task='aol', test_batch_size=512)

Epoch  1 / 3
Best Result: MAP: 0.5050 MRR: 0.5145 NDCG@1: 0.3553 NDCG@3: 0.4999 NDCG@5: 0.5358 NDCG@10: 0.5702
Best Result: MAP: 0.5161 MRR: 0.5255 NDCG@1: 0.3660 NDCG@3: 0.5154 NDCG@5: 0.5464 NDCG@10: 0.5808
Best Result: MAP: 0.5223 MRR: 0.5314 NDCG@1: 0.3728 NDCG@3: 0.5198 NDCG@5: 0.5539 NDCG@10: 0.5865
Best Result: MAP: 0.5267 MRR: 0.5357 NDCG@1: 0.3782 NDCG@3: 0.5247 NDCG@5: 0.5604 NDCG@10: 0.5912
Best Result: MAP: 0.5355 MRR: 0.5445 NDCG@1: 0.3871 NDCG@3: 0.5333 NDCG@5: 0.5704 NDCG@10: 0.6007
Average loss:0.306113 

Epoch  2 / 3
Best Result: MAP: 0.5363 MRR: 0.5457 NDCG@1: 0.3912 NDCG@3: 0.5343 NDCG@5: 0.5698 NDCG@10: 0.6011
Best Result: MAP: 0.5388 MRR: 0.5481 NDCG@1: 0.3921 NDCG@3: 0.5369 NDCG@5: 0.5727 NDCG@10: 0.6033
Best Result: MAP: 0.5433 MRR: 0.5525 NDCG@1: 0.3976 NDCG@3: 0.5422 NDCG@5: 0.5777 NDCG@10: 0.6074
Average loss:0.247712 

Epoch  3 / 3
Average loss:0.209425 
start test...
Best Result: MAP: 0.5452 MRR: 0.5554 NDCG@1: 0.3969 NDCG@3: 0.5422 NDCG@5: 0.5795 NDCG@10: 0.6110
write success
[Modelarts Service Log]Training end with return code: 0
[Modelarts Service Log]handle outputs of training job
[Modelarts Service Log][modelarts_logger] modelarts-pipe found
INFO:root:Using MoXing-v1.17.1-47ce498c
INFO:root:Using OBS-Python-SDK-3.1.2
[ModelArts Service Log][INFO][2021/05/14 11:53:36]: env MA_OUTPUTS is not found, skip the outputs handler
[Modelarts Service Log]Training completed.
